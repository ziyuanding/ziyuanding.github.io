<nav>
  <div class="ui grid container">

    <div class="computer only row"> <!-- Layout for computers only -->
      <div class="ui fluid large borderless blue menu">
        {{ partial "nav/logo.html" . }}
        <div class="item">
          <div class="item" style="position: relative;">
            <div class="ui fluid transparent icon input">
              <input id="search-box" type="text" placeholder="Search posts...">
              <i class="search icon"></i>
            </div>
            <ul id="search-results">
            </ul>
          </div>
        </div>
        <div class="right menu">
          <div class="ui item">
            <a href="/about" style="text-decoration: none; color: #000000;"><b>ABOUT</b></a>
          </div>
          <div class="ui item" style="padding-left: 5px !important;
    padding-right: 5px !important;">
            <a href="https://www.linkedin.com/in/ziyuan-ding-467314249/" target="_blank"
              style="text-decoration: none; color: #000000;">
              <i class="linkedin icon"></i>
            </a>
          </div>
          <div class="ui item" style="padding-left: 5px !important;
    padding-right: 5px !important;">
            <a href="https://github.com/ziyuanding" target="_blank" style="text-decoration: none; color: #000000;">
              <i class="github icon"></i>
            </a>
          </div>
        </div>
      </div>
      <!--          <a href="https://forms.gle/9yAv3AFjjkvXKrf77" target = "_blank" ><button class="ui green big button">Add Entry</button></a>
          <a href="https://forms.gle/hm3PwHBFBTn3a6sk9" target = "_blank" ><button class="ui blue big button">Monthly Newsletter</button></a>
COMMENT OUT THIS UI ELEMENT AS IT SEEMS NO LONGER SUPPORTED !-->
    </div>

    <div class="tablet only row"> <!-- Layout for tablets only -->
      <div class="ui fluid large borderless blue menu">
        {{ partial "nav/logo.html" . }}
        <div class="item">
          <div class="item" style="position: relative;">
            <div class="ui fluid transparent icon input">
              <input id="search-box" type="text" placeholder="Search posts...">
              <i class="search icon"></i>
            </div>
            <ul id="search-results">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="mobile only row"> <!-- Layout for mobiles only -->
      <div class="ui fluid borderless blue menu xo marginless">
        {{ partial "nav/logo.html" . }}
      </div>
      <div class="ui fluid borderless menu xo marginless center aligned">
        <div class="item">
          <div class="item" style="position: relative;">
            <div class="ui fluid transparent icon input">
              <input id="search-box" type="text" placeholder="Search posts...">
              <i class="search icon"></i>
            </div>
            <ul id="search-results">
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>
</nav>
<style>
  #search-box {
    position: relative;
    z-index: 10;
    /* 确保输入框在结果之上 */
  }

  /* 搜索结果列表的样式 */
  #search-results {
    position: absolute;
    top: 100%;
    /* 紧贴输入框底部 */
    left: 0;
    width: 100%;
    /* 与输入框同宽 */
    background: white;
    /* 或与你主题一致的颜色 */
    border: 1px solid #ccc;
    border-top: none;
    max-height: 250px;
    /* 可滚动，避免太长 */
    overflow-y: auto;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    z-index: 9999;
    display: none;
    /* 初始隐藏 */
    list-style: none;
    padding: 0;
    margin: 0;
  }

  #search-results.show {
    display: block;
    /* 显示结果时添加这个类 */
  }

  /* 每个结果项 */
  #search-results li {
    padding: 8px 12px;
    cursor: pointer;
  }

  #search-results li:hover {
    background: #f0f0f0;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
<script>
  async function searchPosts(query) {
    const container = document.getElementById('search-results');

    // 如果输入为空，隐藏结果框
    if (!query.trim()) {
      container.innerHTML = '';
      container.classList.remove('show');
      return;
    }

    const res = await fetch('/index.json');
    const posts = await res.json();
    const fuse = new Fuse(posts, {
      keys: ['title', 'content'],
      threshold: 0.3
    });
    const result = fuse.search(query);

    // 渲染结果
    container.innerHTML = result.map(r =>
      `<li><a href="${r.item.url}">${r.item.title}</a></li>`
    ).join('');

    // 如果有结果则显示，否则隐藏
    if (result.length > 0) {
      container.classList.add('show');
    } else {
      container.classList.remove('show');
    }
  }

  const searchBox = document.getElementById('search-box');
  const container = document.getElementById('search-results');

  searchBox.addEventListener('input', e => {
    searchPosts(e.target.value);
  });

  // 点击页面其他地方时关闭结果
  document.addEventListener('click', e => {
    if (!e.target.closest('#search-box') && !e.target.closest('#search-results')) {
      container.classList.remove('show');
    }
  });
</script>